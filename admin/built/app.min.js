angular.module("RAAdminTemplates",[]).run(["$templateCache",function(n){n.put("/admin/templates/home.html",'<h1>Remote.Academy Administration Interface</h1>\n<h4 class="red">Currently Experimental - Use With Caution!</h4>\n'),n.put("/admin/templates/lab-editor.html",'<h1>Lab Editor</h1>\n<md-content class="narrow form">\n  <md-toolbar>\n    <div class="md-toolbar-tools">\n      <h2><span>Editing: {{lec.lab.title || \'New Lab\'}}</span></h2>\n      <span flex></span>\n      <md-button aria-label="Delete Lab"  ng-click="lec.deleteLab()">\n        <md-icon md-icon-set="material-icons">delete forever</md-icon>Delete\n      </md-button>\n      <a href="/lab/{{lec.lab._id}}" target="_new" ng-show="!lec.newLab">\n        <md-button aria-label="Preview Lab">\n          <md-icon md-icon-set="material-icons">pageview</md-icon>Preview\n        </md-button>\n      </a>\n      <md-button aria-label="Save Changes" ng-click="lec.saveChanges()">\n        <md-icon md-icon-set="material-icons">save</md-icon>\n        {{ (lec.newLab) ? "Create Lab" : "Save Changes" }}\n      </md-button>\n    </div>\n    <md-progress-linear md-mode="indeterminate" ng-show="lec.saving">\n    </md-progress-linear>\n  </md-toolbar>\n  <div class="form">\n    <div layout-gt-sm="row">\n      <md-input-container class="md-block" style="width: 350px">\n        <label>Title</label>\n        <input ng-model="lec.lab.title">\n      </md-input-container>\n      <md-input-container class="md-block" style="width: 100%">\n        <label>Subtitle</label>\n        <input ng-model="lec.lab.subtitle">\n      </md-input-container>\n    </div>\n    <h4>Due Date</h4>\n    <div layout-gt-sm="row">\n      <md-input-container class="md-block" style="width: 100%; min-width: 150px" >\n        <label>Month</label>\n        <md-select ng-model="lec.due.month" ng-change="lec.updateTimestamp()">\n          <md-option value="1">January</md-option>\n          <md-option value="2">February</md-option>\n          <md-option value="3">March</md-option>\n          <md-option value="4">April</md-option>\n          <md-option value="5">May</md-option>\n          <md-option value="6">June</md-option>\n          <md-option value="7">July</md-option>\n          <md-option value="8">August</md-option>\n          <md-option value="9">September</md-option>\n          <md-option value="10">October</md-option>\n          <md-option value="11">November</md-option>\n          <md-option value="12">December</md-option>\n        </md-select>\n      </md-input-container>\n      <md-input-container class="md-block" style="width: 100%; max-width: 150px">\n        <label>Day</label>\n        <md-select ng-model="lec.due.day" ng-change="lec.updateTimestamp()">\n          <md-option value="{{value}}" ng-repeat="value in lec.dayrange">\n            {{value}}\n          </md-option>\n        </md-select>\n      </md-input-container>\n      <md-input-container class="md-block" style="width: 100%">\n        <label>Year</label>\n        <input ng-model="lec.due.year" ng-change="lec.updateTimestamp()">\n      </md-input-container>\n      <md-input-container class="md-block" style="width: 100%">\n        <label>Time</label>\n        <md-select ng-model="lec.due.time" ng-change="lec.updateTimestamp()">\n          <md-option ng-repeat="time in lec.times" value="{{time.value}}">\n            {{time.name}}\n          </md-option>\n        </md-select>\n      </md-input-container>\n    </div>\n    <ra-admin-link-input\n      collection="classes" ids="lec.lab.classes"\n      title="Visible to classes"\n      message="Adding this lab to a class will make it visible to all students of that class">\n    </ra-admin-link-input>\n    <ra-admin-accordion class="list-section"\n      has-header="true" header-title="Lab Notebook Sections"\n      header-actions="lec.sectionHeaderActions">\n      <ra-admin-accordion-item ng-repeat="(si, section) in lec.lab.sections"\n        lab-id="{{lec.lab._id}}"\n        name="section.name" index="{{si}}" actions="lec.sectionActions">\n        <ra-admin-lab-section-editor section="section" index="{{si}}">\n        </ra-admin-lab-section-editor>\n      </ra-admin-accordion-item>\n      <h4 ng-if="lec.lab.sections.length == 0">No sections yet</h4>\n    </ra-admin-accordion>\n    <md-button class="md-raised md-primary save" ng-click="lec.saveChanges()">\n      {{ (lec.newLab) ? "Create Lab" : "Save Changes" }}\n    </md-button>\n  </div>\n</md-content>\n'),n.put("/admin/templates/lab.html",'<h1>Lab Viewer</h1>\n<md-content class="form">\n  <md-toolbar>\n    <div class="md-toolbar-tools">\n      <md-button aria-label="Search">\n        <md-icon md-icon-set="material-icons">search</md-icon>Search\n      </md-button>\n      <span flex></span>\n      <md-button aria-label="Add New" ng-click="lec.newLab()">\n        <md-icon md-icon-set="material-icons">add circle</md-icon>Add New Lab\n      </md-button>\n    </div>\n  </md-toolbar>\n  <ra-admin-data-table data="lec.data" columns="lec.columns" actions="lec.actions">\n  </ra-admin-data-table>\n</md-content>\n'),n.put("/admin/templates/raletest.html",'<h1>Simulate a live LabBox</h1>\n<h4 class="red">Never do this on an active experiment</h4>\n\n<hr/>\n\n<div layout-gt-xs="row" class="mainbox">\n  <md-input-container>\n    <label>LabBox Identifier</label>\n    <input ng-model="rtc.boxid">\n  </md-input-container>\n  <md-button class="md-raised md-primary" ng-click="rtc.lookup(rtc.boxid)">Find LabBox</md-button>\n</div>\n\n<hr/>\n\n<div ng-show="rtc.hasExperiment === false">\n  <h3 class="red">This LabBox is not attached to any Experiment</h3>\n  You can attach an imaginary LabBox ID to an experiment in the Experiments tab.\n</div>\n\n<div ng-show="rtc.hasExperiment === true">\n  <h1>Found experiment: {{rtc.experiment.name}}</h1>\n  <ul class="discreetList">\n    <li ng-repeat="(name, device) in rtc.experiment.setup">\n      <h4>Device: {{name}}</h4>\n      <ul class="discreetList">\n        <li ng-repeat="input in device.inputs">\n          <span>{{input.id}} = {{input.value}}</span>\n        </li>\n      </ul><br/>\n      <ul class="discreetList">\n        <li ng-repeat="output in device.outputs">\n          <h4>Output: {{output.id}}</h4>\n          <div layout-gt-sm="row" class="outputrow">\n            <md-input-container class="md-block" flex-gt-sm>\n              <label>Generation Option</label>\n              <md-select ng-model="output.generation">\n                <md-option value="random" default>Random Values</md-option>\n                <md-option value="sine1000">1s Sine Wave</md-option>\n                <md-option value="sine100">100ms Sine Wave</md-option>\n                <md-option value="set">Set Value</md-option>\n              </md-select>\n            </md-input-container>\n            <md-input-container class="md-block" flex-gt-sm>\n              <label>Sampling Period (ms)</label>\n              <input ng-model="output.period">\n            </md-input-container>\n            <md-input-container class="md-block" flex-gt-sm>\n              <label>Set Value</label>\n              <input ng-model="output.set" ng-disabled="output.generation != \'set\'">\n            </md-input-container>\n          </div>\n      </ul>\n    </li>\n  </ul>\n  <br/>\n  <div layout-gt-xs="row" class="mainbox">\n    <md-input-container>\n      <label>WS Send Period (ms)</label>\n      <input ng-model="rtc.sendrate">\n    </md-input-container>\n    <md-button class="md-raised md-primary" ng-click="rtc.toggleSimulation(rtc.boxid)">\n      {{rtc.simulating ? "Stop Simulation" : "Start Simulating LabBox"}}\n    </md-button>\n  </div><br/>\n  <h4>Status: {{\n    !rtc.simulating ? "Waiting to Inject Simulation" :\n    rtc.collecting ? \'Collecting Data\' :\n    rtc.connected ? \'Connected to Client\' : \'Waiting for Client\'\n  }}</h4>\n</div>\n'),n.put("/admin/templates/dataTable/template.html",'<table class="datatable" cellspacing="0" cellpadding="0">\n  <tr class="head">\n    <th ng-repeat="column in columns"\n        ng-bind="column.label" ng-style="{width: column.width}">\n    </th>\n    <th colspan="{{actions.length}}">Actions</th>\n  </tr>\n  <tr ng-repeat="row in _processed" class="datarow">\n    <td ng-repeat="column in columns">\n      <span ng-bind="row[column.key]"></span>\n    </td>\n    <td ng-repeat="action in actions" class="actionitem"\n        ng-click="runAction($index, row._id)"><span>\n      <md-icon md-icon-set="material-icons" title="{{action.label}}">\n        {{action.icon}}\n      </md-icon>\n    </span></td>\n  </tr>\n  <tr ng-show="_processed.length == 0">\n    <td colspan="{{real_columns.length}}" class="tableEmpty">No Rows Match/td>\n  </tr>\n</table>\n'),n.put("/admin/templates/imageUpload/template.html",'<div ng-model="file" class="imageUpload"\n    ngf-drop ngf-select ngf-multiple="false" ngf-allow-dir="false"\n    ngf-drag-over-class="\'dragover\'"class="drop-box"\n    accept="image/*" ngf-pattern="\'image/*\'">\n  <div ng-show="!uploading && !link" class="empty">\n    Drop an image here or click to upload\n  </div>\n  <div ng-show="!uploading && link" class="uploaded">\n    <div layout-gt-sm="row" class="editor-row">\n      <img src="{{link}}" alt="Uploaded Image" />\n      <p>Drop or click here to replace this image</p>\n    </div>\n  </div>\n  <div ng-show="uploading" class="uploading">\n    <md-progress-circular\n       md-mode="indeterminate" md-diameter="30px"\n    ></md-progress-circular>\n    <p>Uploading File</p>\n  </div>\n</div>\n'),n.put("/admin/templates/labSectionEditor/lab-section-editor.html",'<md-card ng-repeat="(fi, field) in section.content">\n  <div layout-gt-sm="row" class="header">\n    <md-icon class="header-icon" md-icon-set="material-icons">{{\n      (field.type == \'text\') ?        \'text_fields\' :\n      (field.type == \'image\') ?       \'camera_alt\'  :\n      (field.type == \'shortanswer\') ? \'input\' :\n      \'view_list\'\n    }}</md-icon>\n    <h5 class="title">{{\n      (field.type == \'text\') ?        \'Instructions / Static Text\' :\n      (field.type == \'image\') ?       \'Image / Diagram\'  :\n      (field.type == \'shortanswer\') ? \'Input: Text\' :\n      \'Input: Table\'\n    }}</h5>\n    <span flex></span>\n    <md-button aria-label="Move Up" class="md-icon-button" ng-if="fi > 0"\n        ng-click="move_up(fi)">\n      <md-icon md-icon-set="material-icons">arrow_upwards</md-icon>\n    </md-button>\n    <md-button aria-label="Move Down" class="md-icon-button"\n        ng-click="move_down(fi)" ng-if="fi < section.content.length - 1">\n      <md-icon md-icon-set="material-icons">arrow_downwards</md-icon>\n    </md-button>\n    <md-button aria-label="Delete Item" class="md-icon-button"\n        ng-click="delete(fi)">\n      <md-icon md-icon-set="material-icons">delete forever</md-icon>\n    </md-button>\n  </div>\n\n  <!-- Text Editor -->\n  <div class="fields" ng-if="field.type == \'text\'">\n    <textarea ng-model="field.content" placeholder="Lorem Ipsum Dolor"></textarea>\n  </div>\n\n  <!-- Image Editor -->\n  <div class="fields" ng-if="field.type == \'image\'">\n    <div layout-gt-sm="row" class="editor-row">\n      <ra-admin-image-upload lab-id="{{labId}}" link="field.content">\n      </ra-admin-image-upload>\n    </div>\n  </div>\n\n  <!-- Short Answer Question Editor -->\n  <div class="fields" ng-if="field.type == \'shortanswer\'">\n    <div layout-gt-sm="row" class="editor-row">\n      <md-input-container class="md-block" style="width: 200px">\n        <label>Question Name / ID</label>\n        <input ng-model="field.name"/>\n      </md-input-container>\n      <md-input-container class="md-block"  style="width: 100%">\n        <label>Prompt</label>\n        <input ng-model="field.label"/>\n      </md-input-container>\n    </div>\n  </div>\n\n</md-card>\n\n<!-- Add new section-->\n<md-fab-toolbar md-direction="left">\n  <md-fab-trigger class="align-with-text">\n    <md-button aria-label="menu" class="md-fab md-primary">\n      <md-icon md-icon-set="material-icons">add</md-icon>\n    </md-button>\n  </md-fab-trigger>\n  <md-toolbar>\n    <md-fab-actions class="md-toolbar-tools">\n      <md-button aria-label="Instructions / Static Text"\n          ng-click="add(\'text\')">\n        <md-icon md-icon-set="material-icons">text_fields</md-icon> Static Text\n      </md-button>\n      <md-button aria-label="Image / Diagram"\n          ng-click="add(\'image\')">\n        <md-icon md-icon-set="material-icons">camera_alt</md-icon> Image\n      </md-button>\n      <md-button aria-label="Input: Text"\n          ng-click="add(\'shortanswer\')">\n        <md-icon md-icon-set="material-icons">input</md-icon> Text Input\n      </md-button>\n      <md-button aria-label="Input: Table"\n          ng-click="add(\'table\')">\n        <md-icon md-icon-set="material-icons">view_list</md-icon> Data Table Input\n      </md-button>\n    </md-fab-actions>\n  </md-toolbar>\n</md-fab-toolbar>\n'),n.put("/admin/templates/linkInput/add-link-dialog.html",'<md-dialog aria-label="Add New Link" ng-cloak style="min-width: 500px">\n  <md-toolbar>\n    <div class="md-toolbar-tools">\n      <h2>Add New Link</h2>\n      <span flex></span>\n      <md-button class="md-icon-button" ng-click="dlg.cancel()">\n        <md-icon md-icon-set="material-icons" aria-label="Close dialog">close</md-icon>\n      </md-button>\n    </div>\n  </md-toolbar>\n  <md-dialog-content>\n    <div class="md-dialog-content">\n      <p>{{dlg.message}}</p><br/>\n      <form ng-submit="$event.preventDefault()">\n        <md-autocomplete\n            md-selected-item="dlg.selectedItem"\n            md-search-text="dlg.searchText"\n            md-items="item in dlg.search(dlg.searchText)"\n            md-item-text="item.name || item.title"\n            md-min-length="0"\n            placeholder="Search by name">\n          <md-item-template>\n            <span md-highlight-text="dlg.searchText" md-highlight-flags="^i">\n              {{item.name || item.title}}\n            </span>\n          </md-item-template>\n          <md-not-found>\n            No classes matching "{{dlg.searchText}}" were found.\n          </md-not-found>\n        </md-autocomplete>\n      </form>\n    </div>\n  </md-dialog-content>\n  <md-dialog-actions>\n    <md-button aria-label="Finished" ng-click="dlg.finish($event)">Finished</md-button>\n  </md-dialog-actions>\n</md-dialog>\n'),n.put("/admin/templates/linkInput/template.html",'<md-list ng-cloak>\n  <md-subheader class="md-no-sticky">\n    <div layout-gt-sm="row" layout-align="center center">\n      <p>{{title}}</p>\n      <span flex></span>\n      <md-button aria-label="Add Link" class="md-secondary" ng-click="add()">\n        <md-icon md-icon-set="material-icons">add</md-icon> Add New\n      </md-button>\n    </div>\n  </md-subheader>\n  <md-list-item ng-repeat="($index, link) in links" data-id="{{link._id}}">\n    <p>{{ link.name || link.title }}</p>\n    <span flex></span>\n    <md-button\n        aria-label="Delete Link" class="md-secondary md-icon-button"\n        ng-click="delete($index)">\n      <md-icon md-icon-set="material-icons">delete forever</md-icon>\n    </md-button>\n  </md-list-item>\n</md-list>\n<h4 ng-if="!links">Loading {{collection}}</h4>\n<h4 ng-if="links && links.length == 0">No links to {{collection}}</h4>\n')}]);var AddDialogController,bind=function(n,e){return function(){return n.apply(e,arguments)}};window.RemoteAcademy=window.RA={Controllers:{},Directives:{},Services:{},Factories:{},Filters:{firstname:function(){return function(n){return n.split(" ")[0]}}}},window.wait=function(n,e){return setTimeout(e,n)},window.every=function(n,e){return setInterval(e,n)},window.RemoteAcademy.Services.raAPI=["$http",function(n){var e,t,i;return e="/admin/api/",i=function(n,e){return console.log("[API: "+n+"] Request Failed. ERROR:"),console.log(e)},t=function(n,e){return 500===e.status?i(n,"Internal Server Error"):200!==e.status?i(n,"HTTP Error Code "+e.status):null==e.data||""===e.data?i(n,"Received Empty Response"):0!==e.data.error?i(n,"Server Error Response: "+e.data.error):e.data.data},this.get=function(o,a,r){return null==a&&(a=o),null==r&&(r=e),n.get(""+r+o+"?nc="+Math.random())["catch"](i.bind(this,a)).then(t.bind(this,a))},this.post=function(o,a,r){return null==r&&(r=o),n.post(""+e+o,a)["catch"](i.bind(this,r)).then(t.bind(this,r))},this.getSocketId=function(){return this.get("socketauth","GetSocketID","/api/")},this.listLabs=function(){return this.get("labs/list","ListLabs")},this.experimentForLabbox=function(n){return this.get("experiments/forlabbox/"+n,"ExperimentForBox")},this.objectId=function(){return this.get("objectid","GetObjectID")},this.getRow=function(n,e){return this.get("crud/get/"+n+"/"+e,"GetDocument")},this["delete"]=function(n,e){return this.get("crud/delete/"+n+"/"+e,"DeleteDocument")},this.insert=function(n,e){return this.post("crud/insert/"+n,e,"InsertDocument")},this.replace=function(n,e){return this.post("crud/replace/"+n,e,"ReplaceDocument")},this.documentsByIds=function(n,e,t){return this.post("crud/ids/"+n+"?fields="+JSON.stringify(t),{ids:e},"DocumentsByIds")},this.documentsByName=function(n,e,t){return null==e?[]:this.post("crud/query/"+n,{query:{$or:[{name:{$regex:e,$options:"i"}},{title:{$regex:e,$options:"i"}}]},fields:t},"DocumentsByIds")},this}],window.RemoteAcademy.Factories.socket=["$rootScope","raAPI",function(n,e){var t,i;return i=void 0,t=!1,{connect:function(o,a){var r;return null==a&&(a="/client"),t&&i.disconnect(),r=-1===window.location.origin.indexOf("localhost")?"sockets.remote.academy:8000":window.location.origin,i=io.connect(r+a,{transports:["websocket"]}),i.on("failed",function(n){return o(!1,n)}),e.getSocketId().then(function(e){return i.emit("identity",e,function(e){return null==e?(t=!0,n.$apply(function(){return o(!0)})):n.$apply(function(){return o(!1,e.message)})})})},on:function(e,t){return i.on(e,function(e){var o;return o=arguments,n.$apply(function(){return t.apply(i,o)})})},once:function(e,t){return i.once(e,function(e){var o;return o=arguments,n.$apply(function(){return t.apply(i,o)})})},emit:function(e,t,o){return i.emit(e,t,function(){var e;return e=arguments,n.$apply(function(){return null!=o?o.apply(i,e):void 0})})}}}],window.RemoteAcademy.Directives.raAdminAccordion=function(){return{restrict:"E",transclude:!0,replace:!0,scope:{openIndex:"@",hasHeader:"@",headerTitle:"@",headerActions:"="},template:'<md-list>\n  <md-subheader class="md-no-sticky" ng-show="{{hasHeader}}">\n    <div layout-gt-sm="row" layout-align="center center">\n      <p>{{headerTitle}}</p>\n      <span flex></span>\n      <md-button ng-repeat="(ai, action) in headerActions"\n        aria-label="{{action.label}}" class="md-secondary"\n        ng-click="perform(ai)">\n        <md-icon md-icon-set="material-icons">{{action.icon}}</md-icon> {{action.label}}\n      </md-button>\n    </div>\n  </md-subheader>\n  <ng-transclude></ng-transclude>\n</md-list>',controller:["$scope","$timeout",function(n,e){return null==n.openIndex&&(n.openIndex=0),this.items=[],this.addItem=function(t){return function(i){return t.items.push(i),t.items.length-1===n.openIndex&&e(function(){return i.opened=!0},10),t.items.length-1}}(this),this.open=function(e){return function(t){return e.items[n.openIndex].opened=!1,n.openIndex=t,e.items[n.openIndex].opened=!0}}(this),n.perform=function(e){var t,i;return null!=(t=n.headerActions)&&null!=(i=t[e])?i.execute():void 0},this}]}},window.RemoteAcademy.Directives.raAdminAccordionItem=function(){return{restrict:"E",transclude:!0,require:"^raAdminAccordion",replace:!0,scope:{name:"=",index:"@",actions:"="},template:'<div ng-click="open()" class="accordionListItem">\n  <md-list-item ng-class="{open: opened}">\n    <md-icon md-icon-set="material-icons" class="arrow">\n      {{opened ? "keyboard_arrow_down" : "keyboard_arrow_right"}}\n    </md-icon>\n    <p contenteditable ng-model="name"></p>\n    <div class="md-secondary action-controls">\n      <md-button ng-repeat="(ai, action) in actions"\n          aria-label="{{action.label}}" class="md-icon-button"\n          ng-click="perform($event, ai)">\n        <md-icon md-icon-set="material-icons">{{action.icon}}</md-icon>\n      </md-button>\n    </div>\n  </md-list-item>\n  <div class="outer" ng-show="_animOpened" ng-style="{height: height + \'px\'}">\n    <div class="inner">\n      <ng-transclude></ng-transclude>\n    </div>\n  </div>\n</div>',link:function(n,e,t,i){var o;return n.opened=!1,o=i.addItem(n),n.open=i.open.bind(this,o),n.inner=e[0].querySelector(".inner")},controller:["$scope","$timeout",function(n,e){return n.height=0,n._animOpened=!1,n.$watch("opened",function(n){return function(e,t){return e&&!t&&n.open(),t&&!e?n.close():void 0}}(this)),this.open=function(){return n._animOpened=!0,e(function(){return n.height=n.inner.offsetHeight},5)},this.close=function(){return n.height=0,e(function(){return n._animOpened=!1},200)},n.$watch(function(e){return function(){return n.inner.offsetHeight}}(this),function(e){return function(){return n._animOpened?n.height=n.inner.offsetHeight:void 0}}(this)),n.perform=function(e,t){var i,o;return null!=(i=n.actions)&&null!=(o=i[t])?o.execute(e,parseInt(n.index)):void 0}}]}},window.RemoteAcademy.Directives.contenteditable=["$parse",function(n){return{restrict:"A",require:"?ngModel",link:function(e,t,i,o){var a;if(o)return o.$render=function(){return t.html(o.$viewValue||"")},a=function(){var n;return n=t.html(),n=n.replace("&nbsp;"," ").replace("&amp;","&"),o.$setViewValue(n)},t.html(n(i.ngModel)(e)),t.on("blur keyup change",function(){return e.$apply(a)}),a()}}}],window.RemoteAcademy.Directives.raAdminDataTable=function(){return{restrict:"E",scope:{columns:"=",actions:"=",data:"="},templateUrl:"/admin/templates/dataTable/template.html",controller:["$scope",function(n){var e;return e=function(n,e){var t,i,o,a,r,l,c,s;for(c=[],o=0,r=n.length;r>o;o++){for(s=n[o],i={_id:s._id},a=0,l=e.length;l>a;a++)t=e[a],null!=t.map?i[t.key]=t.map(s[t.key]):i[t.key]=s[t.key];c.push(i)}return c},n._processed=e(n.data,n.columns),n.$watchCollection("data",function(){return n._processed=e(n.data,n.columns)}),n.runAction=function(e,t){var i;return i=n.actions[e],null==i?alert("Could not perform action"):i.confirm?confirm("Are you sure you want to perform '"+i.label+"' on this row?")?i.execute(t):void 0:i.execute(t)}}]}},window.RemoteAcademy.Directives.raAdminImageUpload=function(){return{restrict:"E",replace:!1,scope:{labId:"@",link:"="},templateUrl:"/admin/templates/imageUpload/template.html",controller:["$scope","Upload","$timeout",function(n,e,t){return n.$watch("file",function(){return n.upload(n.file)}),n.upload=function(i){return null==i||i.$error?void 0:(n.uploading=!0,e.upload({url:"/admin/api/images/upload/"+(n.labId||"unknown"),data:{file:i}}).then(function(e){return t(function(){return n.uploading=!1,n.success=200===e.status,n.link=e.data.data})},null,function(n){var e;return e=parseInt(100*n.loaded/n.total)}))}}]}},window.RemoteAcademy.Directives.raAdminLabSectionEditor=function(){return{restrict:"E",replace:!1,scope:{section:"=",index:"@",labId:"@"},templateUrl:"/admin/templates/labSectionEditor/lab-section-editor.html",controller:["$scope",function(n){return n.add=function(e){return n.section.content.push({type:e})},n.move_up=function(e){var t;if(0!==e)return t=n.section.content[e],n.section.content.splice(e,1),n.section.content.splice(e-1,0,t)},n.move_down=function(e){var t;if(e!==n.section.content.length-1)return t=n.section.content[e],n.section.content.splice(e,1),n.section.content.splice(e+1,0,t)},n["delete"]=function(e){return confirm("Are you sure you want to delete this field?")?n.section.content.splice(e,1):void 0}}]}},window.RemoteAcademy.Directives.raAdminLinkInput=function(){return{restrict:"E",scope:{collection:"@",message:"@",title:"@",ids:"="},templateUrl:"/admin/templates/linkInput/template.html",controller:["$scope","raAPI","$mdDialog",function(n,e,t){var i;return i=function(t){return function(t){return null==t||0===t.length?n.links=[]:e.documentsByIds(n.collection,t,{name:1,title:1,_id:1}).then(function(e){return n.links=e})}}(this),n.add=function(e){var o;return o=n.$new(),t.show({controller:AddDialogController,controllerAs:"dlg",scope:o,templateUrl:"/admin/templates/linkInput/add-link-dialog.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0})["finally"](function(e){return function(){var e;return e=o.addItemId,null!=e?(n.ids.push(e),i(n.ids)):void 0}}(this))},n["delete"]=function(e){return confirm("Are you sure you want to delete this link?")?n.ids.splice(e,1):void 0},i(n.ids),n.$watchCollection("ids",function(){return i(n.ids)})}]}},AddDialogController=function(){function n(n,e,t){this.message=n.message,this.cancel=function(n){return t.cancel()},this.finish=function(e){var i;return n.addItemId=null!=(i=this.selectedItem)?i._id:void 0,t.hide(this.selectedItem._id)},this.search=function(t){return e.documentsByName(n.collection,t,{name:1,title:1,_id:1})}}return n}(),AddDialogController.$inject=["$scope","raAPI","$mdDialog"],window.RemoteAcademy.Directives.raAdminNav=function(){return{restrict:"E",replace:!1,scope:{links:"="},template:'<header>\n  <h2>Remote.Academy</h2>\n  <h4>Administration Interface</h4>\n</header>\n<hr/>\n<ul>\n  <li   ng-repeat="link in links"\n        ng-click="activate(link)"\n        ng-class="{active: link.active}">\n      {{link.title}}\n  </li>\n</ul>',controller:["$scope","$location",function(n,e){return n.$watch("links",function(t){return function(){var i,o,a,r,l;if(null!=n.links){for(r=n.links,l=[],i=0,o=r.length;o>i;i++)if(a=r[i],e.url()===a.href){t.activeLink=a,t.activeLink.active=!0;break}return l}}}(this)),n.activate=function(n){return function(t){return e.url(t.href),null!=n.activeLink&&(n.activeLink.active=!1),t.active=!0,n.activeLink=t}}(this)}]}},window.RemoteAcademy.Controllers.HomepageController=function(){function n(){console.log("welcome home")}return n}(),window.RemoteAcademy.Controllers.LabEditorController=function(){function n(n,e,t,i,o){var a,r,l;this.lab=n,this.newLab=!1,null!=n&&null!=n._id||(this.newLab=!0,this.lab={classes:[],sections:[]},a=new Date,a.setHours(23),a.setMinutes(59),a.setSeconds(59),a.setMilliseconds(0),this.lab.due=a.getTime()+6048e5,e.objectId().then(function(n){return function(e){return n.lab._id=e}}(this))),l=86399e3,this.dayrange=function(){var n,e;for(e=[],r=n=0;31>=n;r=++n)e.push(r);return e}(),this.times=[{value:0,name:"Midnight"},{value:36e5,name:"1am"},{value:72e5,name:"2am"},{value:108e5,name:"3am"},{value:144e5,name:"4am"},{value:18e6,name:"5am"},{value:216e5,name:"6am"},{value:252e5,name:"7am"},{value:288e5,name:"8am"},{value:324e5,name:"9am"},{value:36e6,name:"10am"},{value:396e5,name:"11am"},{value:432e5,name:"Noon"},{value:468e5,name:"1pm"},{value:504e5,name:"2pm"},{value:54e6,name:"3pm"},{value:576e5,name:"4pm"},{value:612e5,name:"5pm"},{value:648e5,name:"6pm"},{value:684e5,name:"7pm"},{value:72e6,name:"8pm"},{value:756e5,name:"9pm"},{value:792e5,name:"10pm"},{value:828e5,name:"11pm"},{value:l,name:"11:59pm"}],this.updateTimestamp=function(n){return function(){return a=new Date(n.due.year,n.due.month-1,n.due.day),n.lab.due=a.getTime()+parseInt(n.due.time)}}(this),this.updatePicker=function(n){return function(e){return a=new Date,a.setTime(e),n.due={time:1e3*(60*(60*a.getHours()+a.getMinutes())+a.getSeconds()),day:a.getDate(),month:a.getMonth()+1,year:a.getFullYear()}}}(this),this.updatePicker(this.lab.due),this.sectionHeaderActions=[{label:"Add Section",icon:"add",execute:function(n){return function(){var e;return e=o.prompt().title("New Section Name").placeholder("Introduction").ariaLabel("Section Name").ok("Create Section").cancel("Cancel"),o.show(e).then(function(e){return n.lab.sections.push({name:e,content:[]})})}}(this)}],this.sectionActions=[{label:"Move Section Up",icon:"arrow_upward",execute:function(n){return function(e,t){var i;return 0===t?alert("Cannot move top section up"):(i=n.lab.sections[t],n.lab.sections.splice(t,1),n.lab.sections.splice(t-1,0,i))}}(this)},{label:"Move Section Down",icon:"arrow_downward",execute:function(n){return function(e,t){var i;return t===n.lab.sections.length-1?alert("Cannot move bottom section down"):(i=n.lab.sections[t],n.lab.sections.splice(t,1),n.lab.sections.splice(t+1,0,i))}}(this)},{label:"Delete Section",icon:"delete_sweep",execute:function(n){return function(e,t){return confirm("Are you sure you want to delete this section?")?n.lab.sections.splice(t,1):void 0}}(this)}],this.saving=!1,this.saveChanges=function(){return this.saving=!0,this.newLab?e.insert("labs",this.lab).then(function(n){return function(){return i(function(){return n.saving=!1,n.newLab=!1},500)}}(this),function(n){return function(){return alert("Could not create lab! Check your internet connection and try again")}}(this)):e.replace("labs",this.lab).then(function(n){return function(){return i(function(){return n.saving=!1},500)}}(this),function(n){return function(){return alert("Could not save lab! Check your internet connection and try again")}}(this))},this.deleteLab=function(){return confirm("Are you sure you want to delete this lab?")?e["delete"]("labs",this.lab._id).then(function(n){return function(n){return 1===n.ok?window.location="/admin/labs":alert("Could not delete lab. Server returned an error!")}}(this)):void 0}}return n}(),window.RemoteAcademy.Controllers.LabEditorController.$inject=["lab","raAPI","$routeParams","$timeout","$mdDialog"],window.RemoteAcademy.Controllers.LabListController=function(){function n(n,e,t){this.data=n,this.columns=[{label:"Title",key:"title"},{label:"Subtitle",key:"subtitle"},{label:"Due",key:"due",map:function(n){return new Date(n).toLocaleString()}},{label:"Classes",key:"classes",map:function(n){return n.length}}],this.actions=[{label:"Delete",icon:"delete forever",execute:function(n){return function(e){return n["delete"](e)}}(this),confirm:!0},{label:"Duplicate",icon:"content_copy",execute:function(n){return function(e){return n.duplicate(e)}}(this),confirm:!0},{label:"Edit",icon:"edit",execute:function(n){return function(e){return n.edit(e)}}(this)}],this.newLab=function(){return t.url("/admin/labs/new")},this.reload=function(){return e.listLabs().then(function(n){return function(e){return n.data=e}}(this))},this["delete"]=function(n){return e["delete"]("labs",n).then(function(e){return function(t){var i,o,a,r;if(1===t.ok){o=e.data,a=[];for(i in o)r=o[i],r._id===n&&a.push(e.data.splice(i,1));return a}return alert("Could not delete row. Server returned an error!")}}(this))},this.duplicate=function(n){var t,i,o;return i=function(){var e,t,i,a;for(i=this.data,a=[],e=0,t=i.length;t>e;e++)o=i[e],o._id===n&&a.push(o);return a}.call(this)[0],null==i?alert("Could not find entry to duplicate"):(t=angular.copy(i),t.title=t.title+" (copy)",delete t._id,e.insert("labs",t).then(function(n){return function(e){return 1===e.ok?n.reload():alert("Could not duplicate row. Server returned an error!")}}(this)))},this.edit=function(n){return t.url("/admin/labs/edit/"+n)}}return n}(),window.RemoteAcademy.Controllers.LabListController.$inject=["list","raAPI","$location"],window.RemoteAcademy.Controllers.RaleTestController=function(){function n(n,e){this.sendData=bind(this.sendData,this),this.stopDataStream=bind(this.stopDataStream,this),this.startDataStream=bind(this.startDataStream,this),this.stopSimulation=bind(this.stopSimulation,this),this.startSimulation=bind(this.startSimulation,this),this.toggleSimulation=bind(this.toggleSimulation,this),this.socket=n,n.connect(function(n){return n},"/rale"),this.api=e,this.simulating=!1,this.collecting=!1,this.connected=!1,this.sendrate=100,this.dataCount=0,this.dataCache={}}return n.prototype.lookup=function(n){return this.api.experimentForLabbox(n).then(function(n){return function(e){return e===!1?n.hasExperiment=!1:(n.hasExperiment=!0,n.experiment=n.formatExperiment(e))}}(this))},n.prototype.formatExperiment=function(n){var e,t,i,o,a,r,l,c,s,d,u;
s=n.setup;for(e in s){for(t=s[e],d=t.outputs,o=0,r=d.length;r>o;o++)c=d[o],c.generation="random",c.period=10;for(u=t.inputs,a=0,l=u.length;l>a;a++)i=u[a],i.value=i["default"]}return n},n.prototype.toggleSimulation=function(n){return this.simulating?this.stopSimulation():this.startSimulation(n)},n.prototype.startSimulation=function(n){return this.simulating=!0,this.socket.emit("identity",n,function(n){return function(e){if(e.success!==!0)throw new Error("Could not connect");return n.identified=!0}}(this)),this.socket.on("control",function(n){return function(e){var t,i,o,a,r,l;try{for(t=n.experiment.setup[e.device],r=t.inputs,l=[],o=0,a=r.length;a>o;o++)i=r[o],i.id===e.key&&l.push(i.value=e.value);return l}catch(c){return console.log("Received invalid control (input) signal")}}}(this)),this.socket.on("status",function(n){return function(e){return e>0?n.connected=!0:n.connected=!1,5===e||7===e?n.startDataStream():n.stopDataStream()}}(this))},n.prototype.stopSimulation=function(){return this.simulating=!1,this.stopDataStream(),this.socket.connect(function(n){return n},"/rale")},n.prototype.startDataStream=function(){var n,e,t,i,o,a;this.collecting=!0,this.generationLoops=[],this.generationLoops.push(every(this.sendrate,this.sendData)),i=this.experiment.setup,o=[];for(e in i)n=i[e],o.push(function(){var i,o,r,l;for(r=n.outputs,l=[],i=0,o=r.length;o>i;i++)t=r[i],a=(new Date).getTime(),l.push(this.generationLoops.push(every(t.period,function(n){return function(i,o){var a;return a=n.registerData.bind(n,e,i.id),function(){var n;return n=(new Date).getTime()-o,"random"===i.generation&&a(Math.random()),"sine1000"===i.generation&&a(Math.sin(n/1e3)),"sine100"===i.generation&&a(Math.sin(n/100)),"set"===i.generation?a(t.set):void 0}}}(this)(t,a))));return l}.call(this));return o},n.prototype.stopDataStream=function(){var n,e,t,i;if(this.collecting){for(this.collecting=!1,i=this.generationLoops,e=0,t=i.length;t>e;e++)n=i[e],clearInterval(n);return this.dataCache={},this.dataCount=0}},n.prototype.sendData=function(){return this.socket.emit("data",{index:this.dataCount++,data:this.dataCache}),this.dataCache={}},n.prototype.registerData=function(n,e,t){return void 0===this.dataCache[n]&&(this.dataCache[n]=[]),this.dataCache[n].push({time:(new Date).getTime(),data:[{key:e,value:t}]})},n}(),window.RemoteAcademy.Controllers.RaleTestController.$inject=["socket","raAPI"],angular.module("RAAdmin",["ngRoute","RAAdminTemplates","ngMaterial","ngFileUpload"]).controller(window.RA.Controllers).directive(window.RA.Directives).service(window.RA.Services).factory(window.RA.Factories).filter(window.RA.Filters).config(["$routeProvider","$locationProvider","raAPIProvider",function(n,e,t){var i;return i=t.$get(),n.when("/admin",{templateUrl:"/admin/templates/home.html",controller:window.RemoteAcademy.Controllers.HomepageController,controllerAs:"hc"}).when("/admin/labs",{templateUrl:"/admin/templates/lab.html",resolve:{list:function(){return i.listLabs()}},controller:window.RemoteAcademy.Controllers.LabListController,controllerAs:"lec"}).when("/admin/labs/edit/:id",{templateUrl:"/admin/templates/lab-editor.html",resolve:{lab:["$route",function(n){return i.getRow("labs",n.current.params.id)}]},controller:window.RemoteAcademy.Controllers.LabEditorController,controllerAs:"lec"}).when("/admin/labs/new",{templateUrl:"/admin/templates/lab-editor.html",resolve:{lab:function(){return{}}},controller:window.RemoteAcademy.Controllers.LabEditorController,controllerAs:"lec"}).when("/admin/labsim",{templateUrl:"/admin/templates/raletest.html",controller:window.RemoteAcademy.Controllers.RaleTestController,controllerAs:"rtc"}),e.html5Mode({enabled:!0})}]).controller("AdminController",function(){return this.base=window.location.origin,this.user=window.rauser,this.links=[{href:"/admin",title:"Dashboard"},{href:"/admin/labs",title:"Labs"},{href:"/admin/labsim",title:"LabBox Simulator"}],console.log(this.links)});